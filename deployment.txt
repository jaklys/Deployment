document.addEventListener('DOMContentLoaded', function() {
    let isDragging = false;

    document.querySelectorAll('#myTable tr').forEach(row => {
        row.addEventListener('mousedown', (e) => {
            // Aktivace táhnutí a zaškrtnutí checkboxu pouze pokud bylo kliknuto na checkbox
            if (e.target.type === 'checkbox') {
                isDragging = true;
                // Nastavíme checkbox explicitně na zaškrtnutý
                e.target.checked = true;
                toggleRowHighlight(e.target.closest('tr'), true); // Přidání zvýraznění
            }
        });

        row.addEventListener('mouseover', (e) => {
            if (isDragging && e.target.type === 'checkbox') {
                // Během táhnutí nastavíme checkboxy, přes které přejíždíme, na zaškrtnuté
                e.target.checked = true;
                toggleRowHighlight(e.target.closest('tr'), true); // Přidání zvýraznění
            }
        });

        // Ukončení táhnutí při uvolnění tlačítka myši nad řádkem
        row.addEventListener('mouseup', () => isDragging = false);
    });

    // Ukončení táhnutí po uvolnění tlačítka myši kdekoli na stránce
    document.addEventListener('mouseup', () => isDragging = false);

    function toggleRowHighlight(row, isChecked) {
        // Přidání nebo odebrání třídy pro zvýraznění podle stavu checkboxu
        if (isChecked) {
            row.classList.add('has-background-primary');
        } else {
            row.classList.remove('has-background-primary');
        }
    }
});